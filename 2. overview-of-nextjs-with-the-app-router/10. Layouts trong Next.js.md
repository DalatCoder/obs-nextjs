## Layouts trong Next.js

### Root Layout

Mọi ứng dụng Next.js đều cần có một global layout (layout toàn cục) được gọi là root layout. Đây là file `layout.js` nằm trong thư mục `app/`. Khi cố xóa file này, Next.js tự động tạo lại vì nó là bắt buộc.

```
Root layout wrap (bao bọc) toàn bộ ứng dụng, áp dụng cho mọi route và phải chứa thẻ `<html>` và `<body>`:
```

```javascript
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        {/* Navigation và shared UI */}
        <Navigation />
        
        {/* Nội dung page hiện tại */}
        <main>{children}</main>
        
        {/* Footer chung */}
        <footer>Copyright by The Wild Oasis</footer>
      </body>
    </html>
  );
}
```


### Children Prop

Children prop là concept (khái niệm) quan trọng trong React và Next.js. Trong layout, children prop sẽ được populate (điền vào) với nội dung của page hiện tại hoặc nested layout (layout lồng nhau) trong quá trình rendering (kết xuất).

Ví dụ: Khi truy cập `/account`, children prop sẽ là nội dung từ `app/account/page.js`. Khi chuyển sang `/cabins`, children sẽ tự động thay đổi thành nội dung từ `app/cabins/page.js`.

Khái niệm này tương tự Outlet component trong React Router.

### Shared UI (Giao diện chia sẻ)

Layout cho phép chia sẻ UI components trên nhiều pages mà không cần duplicate (nhân bản) code. Các phần tử bên ngoài children prop như navigation, header, footer sẽ xuất hiện trên mọi trang.

Điểm quan trọng: Các phần UI này không bị rerender (kết xuất lại) khi navigate (điều hướng) giữa các pages, chỉ phần children được cập nhật. Điều này tối ưu performance (hiệu suất).

### Page Metadata

Có thể export metadata từ layout để influence (ảnh hưởng) những gì thường nằm trong thẻ `<head>` như title:

```javascript
export const metadata = {
  title: 'The Wild Oasis'
};

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
```

Metadata này sẽ tự động tạo thẻ `<title>` trong HTML output mà không cần viết thủ công.

### Static Assets trong Public Folder

File `public/` chứa static assets (tài nguyên tĩnh) như images, icons. Sử dụng assets từ thư mục này rất đơn giản:

```javascript
import Logo from '@/components/Logo';

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <header>
          <Logo />
        </header>
        <main>{children}</main>
      </body>
    </html>
  );
}
```

Trong component Logo, reference (tham chiếu) đến file trong public folder:

```javascript
export default function Logo() {
  return <img src="/icon.png" alt="Logo" />;
}
```

Không cần prefix `public/` - chỉ cần `/` là đủ. Tương tự như Vite và Create React App.

### Lưu ý về Image Component

Next.js khuyến nghị sử dụng built-in Image component thay vì thẻ `<img>` thông thường để tối ưu hóa hình ảnh tự động. Component này sẽ được học sau.

### Conventions trong Next.js

Next.js dựa trên nhiều conventions:

- **File naming conventions:** `page.js`, `layout.js`, `error.js`, `loading.js`
- **Export conventions:** metadata, default export function
- **Routing conventions:** Tạo route bằng cách tạo folders

Học Next.js chủ yếu là học các conventions mà đội ngũ Next.js đã thiết lập.

### Layout Structure Example

Cấu trúc hoàn chỉnh của root layout:

```javascript
import Navigation from '@/components/Navigation';
import Logo from '@/components/Logo';

export const metadata = {
  title: 'The Wild Oasis'
};

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <header>
          <Logo />
          <Navigation />
        </header>
        
        <main>{children}</main>
        
        <footer>
          Copyright by The Wild Oasis
        </footer>
      </body>
    </html>
  );
}
```


### Server Components

Layouts, giống như pages, là Server Components (các thành phần máy chủ) - chạy và render trực tiếp trên server. Đây là paradigm (mô hình) hoàn toàn mới trong React, mang lại nhiều lợi ích về performance và data fetching.

**Liên kết:** [[Root Layout]], [[Children Prop]], [[Metadata]], [[Server Components]], [[Static Assets]], [[Public Folder]], [[Shared UI]], [[Next.js Conventions]], [[React Router Outlet]]

